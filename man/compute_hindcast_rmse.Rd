% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats.R
\name{compute_hindcast_rmse}
\alias{compute_hindcast_rmse}
\title{Compute hindcast RMSE (observed vs projected)}
\usage{
compute_hindcast_rmse(data, log = TRUE)
}
\arguments{
\item{data}{A long-format data frame with columns (e.g., from \code{obs_pred} in
\code{\link[=fit_hindcast]{fit_hindcast()}} output):
\itemize{
\item \strong{year}: integer assessment year.
\item \strong{age}: integer model age.
\item \strong{obs}: numeric observed value for the given \code{year} × \code{age}.
\item \strong{pred}: numeric projected value for the given \code{year} × \code{age}.
\item \strong{fold}: integer or numeric label for the hindcast peel
(typically the terminal year used in that run).
\item \strong{is_proj}: logical; \code{TRUE} for projection rows (the one–step–ahead
predictions), \code{FALSE} otherwise.
}}

\item{log}{Logical; if \code{TRUE} (default), compute RMSE on the log scale.
Zeros in \code{obs}/\code{pred} are converted to \code{NA} before logging.}
}
\value{
A single numeric value: the RMSE between observed and one–step–ahead projected
values for matched \verb{(year, age)} pairs. Returns \code{NA} if no valid pairs exist.
}
\description{
Calculates the root–mean–squared error (RMSE) between observed values and
one–step–ahead projections from a hindcast run (e.g., a data frame from
\code{hindcasts$obs_pred$catch} or \code{hindcasts$obs_pred$index}).
}
\details{
The function:
\enumerate{
\item Selects one–step–ahead projections via \code{is_proj == TRUE} (projected rows).
\item Extracts observed values at the peel year via \code{year == fold}
(observed rows).
\item Merges observed and projected values by \verb{(year, age)}.
\item Optionally transforms to log scale (after replacing exact zeros with \code{NA}).
\item Computes squared errors \eqn{(\mathrm{obs} - \mathrm{pred})^2} and returns
\deqn{\mathrm{RMSE} = \sqrt{\mathrm{mean}\big[(\mathrm{obs} - \mathrm{pred})^2\big]}}
with \code{na.rm = TRUE}.
}

Notes:
\itemize{
\item If \code{log = TRUE}, exact zeros are dropped (set to \code{NA}) before \code{log()}.
Consider adding a small constant beforehand if you prefer to retain zeros.
\item Only year–age pairs present in \strong{both} the observed-at-fold and projected
sets contribute to the RMSE (via the merge).
}
}
\examples{
\dontrun{
# Suppose `hindcasts <- fit_hindcast(fit, folds = 3)`
# Overall RMSE for the index series on the log scale
compute_hindcast_rmse(hindcasts$obs_pred$index, log = TRUE)

# RMSE for catch on the natural scale
compute_hindcast_rmse(hindcasts$obs_pred$catch, log = FALSE)
}

}
