% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nll.R
\name{solve_F_full}
\alias{solve_F_full}
\title{Solve fully selected fishing mortality from a target catch}
\usage{
solve_F_full(
  C_target,
  F_init,
  S,
  M,
  N,
  n_iter = 7,
  eps = 1e-12,
  clamp_nonneg = TRUE
)
}
\arguments{
\item{C_target}{Numeric scalar; target catch (same units as \code{N}).}

\item{F_init}{Numeric scalar; initial guess for \code{F_full}.}

\item{S}{Numeric vector; selectivity at age (>= 0).}

\item{M}{Numeric vector; natural mortality at age (>= 0).}

\item{N}{Numeric vector; abundance at age (>= 0).}

\item{n_iter}{Integer; number of Newton updates (default \code{7}).}

\item{eps}{Numeric; small constant to stabilize divisions/derivatives (default \code{1e-12}).}
}
\value{
Numeric scalar \code{F_full}.
}
\description{
Computes the scalar fully selected fishing mortality \code{F_full} that achieves a
target catch (numbers scale) under the Baranov catch equation, given
selectivity \code{S}, natural mortality \code{M}, and abundance \code{N}. Uses a fixed number
of Newton updates starting from \code{F_init}.

The catch as a function of \code{F_full} is
\deqn{C(F_{\mathrm{full}}) = F_{\mathrm{full}} \sum_a \left[
  N_a \, \frac{1 - \exp\{-(F_{\mathrm{full}} S_a + M_a)\}}{F_{\mathrm{full}} S_a + M_a} \, S_a
\right].}
}
\details{
This inverts the Baranov catch equation for a single fully selected rate
\code{F_full}, holding \code{S}, \code{M}, and \code{N} fixed. Provide a sensible \code{F_init}.
When the derivative is extremely small, the update is damped by \code{eps}.
}
\examples{
S <- rep(1, 5); M <- rep(0.2, 5); N <- 1000 * exp(-0.2 * (0:4))
F_full_true <- 0.3
catch_of_Ffull <- function(F_full) {
  Z <- F_full * S + M; eZ <- exp(-Z); mort <- 1 - eZ
  F_full * sum(N * mort * S / pmax(Z, 1e-12))
}
C_target <- catch_of_Ffull(F_full_true)
solve_F_full(C_target, F_init = 0.1, S, M, N)

}
